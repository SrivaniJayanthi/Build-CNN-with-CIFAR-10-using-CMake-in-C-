# Project Overview:


To compile and execute this project, we utilize a pre-trained Convolutional Neural Network (CNN) model trained on the CIFAR-10 dataset. The following steps summarize the approach:

## Parameter Extraction:
From the pre-trained CNN model, we extract:

Convolutional Layers: Weights and biases. <br>
Batch Normalization Layers: Gamma, beta, running mean, and running variance.
## Custom CNN Development:
Using the extracted parameters, we construct a customized Convolutional Neural Network. This implementation directly incorporates the learned parameters, ensuring it mimics the behavior of the pre-trained model.

## Model Testing and Verification:
The custom CNN is rigorously tested and verified against the pre-trained PyTorch model. The expected outcome is to replicate the model's performance, achieving an accuracy of 81.5% on the CIFAR-10 dataset.


# Contents of the project folder:

## configs: 
This folder includes a JSON file that specifies the paths to the weights and biases of the pre-trained model. The parameters are extracted from this file to construct the customized CNN. Since most parameters, such as kernel size, strides, and padding, are consistent across all convolutional layers, they were manually defined directly in the [main.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/src/main.cpp) file for simplicity.
## data:
This folder contains three subdirectories:
### input:
This folder includes the following: <br>
Image.py: A Python script that modifies a given image into a 32x32 image matrix, matching the standard input size for the CIFAR-10 dataset. <br>
Image Matrices: Pre-processed image matrices representing all 10 classes from the CIFAR-10 dataset. These matrices were extracted using the Image.py script and are stored within this folder.
### output:
This folder contains all the values extracted from the custom CNN, layer by layer, implemented in C++.
### references:
This folder contains all the values extracted from the trained PyTorch CNN model, layer by layer. These values are used to compare the layer-by-layer output with the custom C++ implementation.

## Operators:
This folder contains two subdirectories:
### include:
This folder contains all the header (.h) files required for implementing the layer-wise logic of the custom CNN.

### src:
This folder is the heart of the project, containing the core logic for all layers of the custom CNN.

## report:
This folder contains: <br>
Layer-wise Comparison Results: Includes the results of comparing each layer between the PyTorch and custom CNN models, along with the time taken for comparison (in milliseconds). <br>
Output Files: Stores the output files generated by both the PyTorch model and the custom CNN implementation.

## src:
This folder contains [main.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/src/main.cpp), which integrates all the layer logic in a structured manner, following the architecture of the PyTorch CNN.

## Test_operators:
This folder contains two sub directories: 
### include:
This folder contains all the header files required for testing and comparing each layer with the PyTorch model. While a single header file would suffice for comparing the layer values (as the logic is the same), I have created separate files for each layer comparison to ensure clarity.
### src:
This folder contains all the .cpp files that implement the logic for comparing the layer-wise values between the PyTorch and custom CNN models.

## utilities:
Similar to the other folders this folder contains header files in [include](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/tree/master/utilities/include) and implementation in [src](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/tree/master/utilities/src). <br>
[Comparisionoutput.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/utilities/src/Comparisionoutput.cpp): Contains the logic for comparing the output between the PyTorch and custom CNN model. <br>
[Comparisionutils.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/utilities/src/Comparisionutils.cpp): Used for comparing the values in each layer between the PyTorch and custom CNN models. <br>
[Conversion.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/utilities/src/Conversion.cpp): This folder contains all the utility functions used for reading and printing matrices, as well as saving files. <br>
[SaveOutput.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/utilities/src/SaveOutput.cpp): This folder contains a function to the save the output to .txt file. <br>
[readers.cpp](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/blob/master/utilities/src/readers.cpp): This folder contains functions to read weights and bias from files.

# Tools and versions:
Operating System : Windows 11 <br>
Version : 23H2 <br>
Architecture : 64 bit OS <br>
IDE : Visual Studio Code (1.96.2) <br>
Build System : CMake (3.31.0) <br>
Compiler : MinGW (14.2.0) <br>
Library : nlohmann/json (3.11.3) <br>
Version Control : Git (2.47.1) <br>

# Run the project:
1. git clone https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-.git <br>

2. cd cpp Project_MCW <br>

3. mkdir build <br>

4. cd build <br>

5. cmake .. <br>

6. ./TestProject1.exe

# Interpret the Results:

## Intermediate Layer Outputs:
Check the [output](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/tree/master/data/output) directory for results from each layer for the tested image.

## Dual Test Results:
View the [reports](https://github.com/SrivaniJayanthi/Build-CNN-with-CIFAR-10-using-CMake-in-C-/tree/master/report) for layer-by-layer comparisons (unit testing). Output files are also available in the same directory, and the results of these files will be displayed in the terminal once the project is built (model testing).
